# Bibop recipe for liba52
# See more: https://kaos.sh/bibop

pkg liba52 liba52-devel

fast-finish yes

var lib_linking_flags "-la52"

command "-" "Check environment"
  app a52dec
  app extract_a52

command "-" "Check shared libs"
  lib-loaded liba52.so.*

command "-" "Check headers"
  lib-header a52dec

command "-" "Check pkg-config"
  lib-config liba52

command "-" "Check symbols exported by liba52.so"
  lib-exported liba52.so a52_bit_allocate
  lib-exported liba52.so a52_bitstream_get_bh
  lib-exported liba52.so a52_bitstream_get_bh_2
  lib-exported liba52.so a52_bitstream_set_ptr
  lib-exported liba52.so a52_block
  lib-exported liba52.so a52_downmix
  lib-exported liba52.so a52_downmix_coeff
  lib-exported liba52.so a52_downmix_init
  lib-exported liba52.so a52_dynrng
  lib-exported liba52.so a52_frame
  lib-exported liba52.so a52_free
  lib-exported liba52.so a52_imdct_256
  lib-exported liba52.so a52_imdct_512
  lib-exported liba52.so a52_imdct_init
  lib-exported liba52.so a52_init
  lib-exported liba52.so a52_samples
  lib-exported liba52.so a52_syncinfo
  lib-exported liba52.so a52_upmix

command "gcc -o test_bin {lib_linking_flags} test.c" "Compile binary with liba52"
  exit 0
  exist test_bin

+command "./test_bin" "Execute built binary"
  exit 0
