# Bibop recipe for PostGIS 2.5 + PostGIS 3.0 for PostgreSQL 12
# See more: https://kaos.sh/bibop

pkg postgresql12-server postgis25_12 postgis25_12-client postgis30_12 postgis30_12-client 

fast-finish yes

var postgres_version 12
var postgis_min_ver  2.5
var postgis_max_ver  3.0

var data_dir /usr/pgsql-{postgres_version}/share
var lib_dir  /usr/pgsql-{postgres_version}/lib
var bin_dir  /usr/pgsql-{postgres_version}/bin

command "-" "Check Postgis {postgis_min_ver}"
  exist {lib_dir}/address_standardizer.so
  exist {lib_dir}/postgis-{postgis_min_ver}.so
  exist {lib_dir}/postgis_topology-{postgis_min_ver}.so
  exist {lib_dir}/rtpostgis-{postgis_min_ver}.so

  mode {lib_dir}/address_standardizer.so 755
  mode {lib_dir}/postgis-{postgis_min_ver}.so 755
  mode {lib_dir}/postgis_topology-{postgis_min_ver}.so 755
  mode {lib_dir}/rtpostgis-{postgis_min_ver}.so 755

command "-" "Check Postgis {postgis_max_ver}"
  exist {lib_dir}/address_standardizer-{postgis_max_ver}.so
  exist {lib_dir}/postgis-{postgis_max_ver}.so
  exist {lib_dir}/postgis_raster-{postgis_max_ver}.so
  exist {lib_dir}/postgis_topology-{postgis_max_ver}.so

  mode {lib_dir}/address_standardizer-{postgis_max_ver}.so 755
  mode {lib_dir}/postgis-{postgis_max_ver}.so 755
  mode {lib_dir}/postgis_raster-{postgis_max_ver}.so 755
  mode {lib_dir}/postgis_topology-{postgis_max_ver}.so 755
