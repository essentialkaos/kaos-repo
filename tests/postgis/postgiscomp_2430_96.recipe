# Bibop recipe for PostGIS 2.4 + PostGIS 3.0 for PostgreSQL 9.6
# See more: https://kaos.sh/bibop

pkg postgresql96-server postgis24_96 postgis24_96-client postgis30_96 postgis30_96-client 

fast-finish yes

var postgres_version 9.6
var postgis_min_ver  2.4
var postgis_max_ver  3

var lib_dir /usr/pgsql-{postgres_version}/lib

command "-" "Check PostGIS 2.x"
  exist {lib_dir}/address_standardizer.so
  exist {lib_dir}/postgis-{postgis_min_ver}.so
  exist {lib_dir}/postgis_topology-{postgis_min_ver}.so
  exist {lib_dir}/rtpostgis-{postgis_min_ver}.so

  mode {lib_dir}/address_standardizer.so 755
  mode {lib_dir}/postgis-{postgis_min_ver}.so 755
  mode {lib_dir}/postgis_topology-{postgis_min_ver}.so 755
  mode {lib_dir}/rtpostgis-{postgis_min_ver}.so 755

command "-" "Check PostGIS 3.x"
  exist {lib_dir}/address_standardizer-{postgis_max_ver}.so
  exist {lib_dir}/postgis-{postgis_max_ver}.so
  exist {lib_dir}/postgis_raster-{postgis_max_ver}.so
  exist {lib_dir}/postgis_topology-{postgis_max_ver}.so

  mode {lib_dir}/address_standardizer-{postgis_max_ver}.so 755
  mode {lib_dir}/postgis-{postgis_max_ver}.so 755
  mode {lib_dir}/postgis_raster-{postgis_max_ver}.so 755
  mode {lib_dir}/postgis_topology-{postgis_max_ver}.so 755
