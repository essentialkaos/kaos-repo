# Bibop recipe for libmetalink
# See more: https://kaos.sh/bibop

pkg libmetalink libmetalink-devel

fast-finish yes

var lib_linking_flags "-lmetalink"

command "-" "Check shared libs"
  lib-loaded libmetalink.so.*

command "-" "Check headers"
  lib-header metalink

command "-" "Check pkg-config"
  lib-config libmetalink

command "-" "Check symbols exported by libmetalink.so"
  lib-exported libmetalink.so copyright_state_end_fun_v4
  lib-exported libmetalink.so copyright_state_start_fun_v4
  lib-exported libmetalink.so delete_metalink_pctrl
  lib-exported libmetalink.so delete_metalink_pstate
  lib-exported libmetalink.so delete_metalink_pstm
  lib-exported libmetalink.so description_state_end_fun_v4
  lib-exported libmetalink.so description_state_start_fun_v4
  lib-exported libmetalink.so error_handler
  lib-exported libmetalink.so files_state_end_fun_v3
  lib-exported libmetalink.so files_state_start_fun_v3
  lib-exported libmetalink.so file_state_end_fun_v3
  lib-exported libmetalink.so file_state_end_fun_v4
  lib-exported libmetalink.so file_state_start_fun_v3
  lib-exported libmetalink.so file_state_start_fun_v4
  lib-exported libmetalink.so fin_state_end_fun
  lib-exported libmetalink.so fin_state_start_fun
  lib-exported libmetalink.so generator_state_end_fun_v4
  lib-exported libmetalink.so generator_state_start_fun_v4
  lib-exported libmetalink.so get_attribute_value
  lib-exported libmetalink.so hash_state_end_fun
  lib-exported libmetalink.so hash_state_start_fun
  lib-exported libmetalink.so identity_state_end_fun_v3
  lib-exported libmetalink.so identity_state_end_fun_v4
  lib-exported libmetalink.so identity_state_start_fun_v3
  lib-exported libmetalink.so identity_state_start_fun_v4
  lib-exported libmetalink.so initial_state_end_fun
  lib-exported libmetalink.so initial_state_start_fun
  lib-exported libmetalink.so language_state_end_fun
  lib-exported libmetalink.so language_state_start_fun
  lib-exported libmetalink.so logo_state_end_fun_v4
  lib-exported libmetalink.so logo_state_start_fun_v4
  lib-exported libmetalink.so metalink_check_safe_path
  lib-exported libmetalink.so metalink_checksum_delete
  lib-exported libmetalink.so metalink_checksum_new
  lib-exported libmetalink.so metalink_checksum_set_hash
  lib-exported libmetalink.so metalink_checksum_set_type
  lib-exported libmetalink.so metalink_chunk_checksum_delete
  lib-exported libmetalink.so metalink_chunk_checksum_new
  lib-exported libmetalink.so metalink_chunk_checksum_set_length
  lib-exported libmetalink.so metalink_chunk_checksum_set_piece_hashes
  lib-exported libmetalink.so metalink_chunk_checksum_set_type
  lib-exported libmetalink.so metalink_delete
  lib-exported libmetalink.so metalink_file_delete
  lib-exported libmetalink.so metalink_file_new
  lib-exported libmetalink.so metalink_file_set_copyright
  lib-exported libmetalink.so metalink_file_set_description
  lib-exported libmetalink.so metalink_file_set_identity
  lib-exported libmetalink.so metalink_file_set_logo
  lib-exported libmetalink.so metalink_file_set_maxconnections
  lib-exported libmetalink.so metalink_file_set_name
  lib-exported libmetalink.so metalink_file_set_publisher_name
  lib-exported libmetalink.so metalink_file_set_publisher_url
  lib-exported libmetalink.so metalink_file_set_size
  lib-exported libmetalink.so metalink_file_set_version
  lib-exported libmetalink.so metalink_get_version
  lib-exported libmetalink.so metalink_handle_parse_result
  lib-exported libmetalink.so metalink_list_append
  lib-exported libmetalink.so metalink_list_clear
  lib-exported libmetalink.so metalink_list_clear_data
  lib-exported libmetalink.so metalink_list_delete
  lib-exported libmetalink.so metalink_list_for_each
  lib-exported libmetalink.so metalink_list_get_data
  lib-exported libmetalink.so metalink_list_length
  lib-exported libmetalink.so metalink_list_new
  lib-exported libmetalink.so metalink_list_to_array
  lib-exported libmetalink.so metalink_metaurl_delete
  lib-exported libmetalink.so metalink_metaurl_new
  lib-exported libmetalink.so metalink_metaurl_set_mediatype
  lib-exported libmetalink.so metalink_metaurl_set_name
  lib-exported libmetalink.so metalink_metaurl_set_priority
  lib-exported libmetalink.so metalink_metaurl_set_url
  lib-exported libmetalink.so metalink_new
  lib-exported libmetalink.so metalink_parse_fd
  lib-exported libmetalink.so metalink_parse_file
  lib-exported libmetalink.so metalink_parse_final
  lib-exported libmetalink.so metalink_parse_fp
  lib-exported libmetalink.so metalink_parse_memory
  lib-exported libmetalink.so metalink_parser_context_delete
  lib-exported libmetalink.so metalink_parser_context_new
  lib-exported libmetalink.so metalink_parse_update
  lib-exported libmetalink.so metalink_pctrl_add_language
  lib-exported libmetalink.so metalink_pctrl_add_os
  lib-exported libmetalink.so metalink_pctrl_checksum_set_hash
  lib-exported libmetalink.so metalink_pctrl_checksum_set_type
  lib-exported libmetalink.so metalink_pctrl_chunk_checksum_set_length
  lib-exported libmetalink.so metalink_pctrl_chunk_checksum_set_piece_hashes
  lib-exported libmetalink.so metalink_pctrl_chunk_checksum_set_type
  lib-exported libmetalink.so metalink_pctrl_commit_checksum_transaction
  lib-exported libmetalink.so metalink_pctrl_commit_chunk_checksum_transaction
  lib-exported libmetalink.so metalink_pctrl_commit_file_transaction
  lib-exported libmetalink.so metalink_pctrl_commit_metaurl_transaction
  lib-exported libmetalink.so metalink_pctrl_commit_piece_hash_transaction
  lib-exported libmetalink.so metalink_pctrl_commit_resource_transaction
  lib-exported libmetalink.so metalink_pctrl_commit_signature_transaction
  lib-exported libmetalink.so metalink_pctrl_detach_metalink
  lib-exported libmetalink.so metalink_pctrl_file_set_copyright
  lib-exported libmetalink.so metalink_pctrl_file_set_description
  lib-exported libmetalink.so metalink_pctrl_file_set_identity
  lib-exported libmetalink.so metalink_pctrl_file_set_language
  lib-exported libmetalink.so metalink_pctrl_file_set_logo
  lib-exported libmetalink.so metalink_pctrl_file_set_maxconnections
  lib-exported libmetalink.so metalink_pctrl_file_set_name
  lib-exported libmetalink.so metalink_pctrl_file_set_os
  lib-exported libmetalink.so metalink_pctrl_file_set_publisher_name
  lib-exported libmetalink.so metalink_pctrl_file_set_publisher_url
  lib-exported libmetalink.so metalink_pctrl_file_set_size
  lib-exported libmetalink.so metalink_pctrl_file_set_version
  lib-exported libmetalink.so metalink_pctrl_get_error
  lib-exported libmetalink.so metalink_pctrl_metalink_accumulate_files
  lib-exported libmetalink.so metalink_pctrl_metaurl_set_mediatype
  lib-exported libmetalink.so metalink_pctrl_metaurl_set_name
  lib-exported libmetalink.so metalink_pctrl_metaurl_set_priority
  lib-exported libmetalink.so metalink_pctrl_metaurl_set_url
  lib-exported libmetalink.so metalink_pctrl_new_checksum_transaction
  lib-exported libmetalink.so metalink_pctrl_new_chunk_checksum_transaction
  lib-exported libmetalink.so metalink_pctrl_new_file_transaction
  lib-exported libmetalink.so metalink_pctrl_new_metaurl_transaction
  lib-exported libmetalink.so metalink_pctrl_new_piece_hash_transaction
  lib-exported libmetalink.so metalink_pctrl_new_resource_transaction
  lib-exported libmetalink.so metalink_pctrl_new_signature_transaction
  lib-exported libmetalink.so metalink_pctrl_piece_hash_set_hash
  lib-exported libmetalink.so metalink_pctrl_piece_hash_set_piece
  lib-exported libmetalink.so metalink_pctrl_resource_set_location
  lib-exported libmetalink.so metalink_pctrl_resource_set_maxconnections
  lib-exported libmetalink.so metalink_pctrl_resource_set_preference
  lib-exported libmetalink.so metalink_pctrl_resource_set_priority
  lib-exported libmetalink.so metalink_pctrl_resource_set_type
  lib-exported libmetalink.so metalink_pctrl_resource_set_url
  lib-exported libmetalink.so metalink_pctrl_set_error
  lib-exported libmetalink.so metalink_pctrl_set_generator
  lib-exported libmetalink.so metalink_pctrl_set_identity
  lib-exported libmetalink.so metalink_pctrl_set_origin
  lib-exported libmetalink.so metalink_pctrl_set_origin_dynamic
  lib-exported libmetalink.so metalink_pctrl_set_published
  lib-exported libmetalink.so metalink_pctrl_set_tags
  lib-exported libmetalink.so metalink_pctrl_set_updated
  lib-exported libmetalink.so metalink_pctrl_set_version
  lib-exported libmetalink.so metalink_pctrl_signature_set_signature
  lib-exported libmetalink.so metalink_piece_hash_delete
  lib-exported libmetalink.so metalink_piece_hash_new
  lib-exported libmetalink.so metalink_piece_hash_set_hash
  lib-exported libmetalink.so metalink_piece_hash_set_piece
  lib-exported libmetalink.so metalink_pstm_character_buffering_enabled
  lib-exported libmetalink.so metalink_pstm_disable_character_buffering
  lib-exported libmetalink.so metalink_pstm_enable_character_buffering
  lib-exported libmetalink.so metalink_pstm_enter_copyright_state_v4
  lib-exported libmetalink.so metalink_pstm_enter_description_state_v4
  lib-exported libmetalink.so metalink_pstm_enter_files_state
  lib-exported libmetalink.so metalink_pstm_enter_file_state
  lib-exported libmetalink.so metalink_pstm_enter_file_state_v4
  lib-exported libmetalink.so metalink_pstm_enter_fin_state
  lib-exported libmetalink.so metalink_pstm_enter_generator_state
  lib-exported libmetalink.so metalink_pstm_enter_hash_state
  lib-exported libmetalink.so metalink_pstm_enter_identity_state
  lib-exported libmetalink.so metalink_pstm_enter_identity_state_v4
  lib-exported libmetalink.so metalink_pstm_enter_language_state
  lib-exported libmetalink.so metalink_pstm_enter_logo_state_v4
  lib-exported libmetalink.so metalink_pstm_enter_metalink_state
  lib-exported libmetalink.so metalink_pstm_enter_metalink_state_v4
  lib-exported libmetalink.so metalink_pstm_enter_metaurl_state_v4
  lib-exported libmetalink.so metalink_pstm_enter_null_state
  lib-exported libmetalink.so metalink_pstm_enter_origin_state
  lib-exported libmetalink.so metalink_pstm_enter_os_state
  lib-exported libmetalink.so metalink_pstm_enter_piece_hash_state
  lib-exported libmetalink.so metalink_pstm_enter_pieces_state
  lib-exported libmetalink.so metalink_pstm_enter_pieces_state_v4
  lib-exported libmetalink.so metalink_pstm_enter_published_state_v4
  lib-exported libmetalink.so metalink_pstm_enter_resources_state
  lib-exported libmetalink.so metalink_pstm_enter_signature_state_v4
  lib-exported libmetalink.so metalink_pstm_enter_size_state
  lib-exported libmetalink.so metalink_pstm_enter_skip_state
  lib-exported libmetalink.so metalink_pstm_enter_tags_state
  lib-exported libmetalink.so metalink_pstm_enter_updated_state_v4
  lib-exported libmetalink.so metalink_pstm_enter_url_state
  lib-exported libmetalink.so metalink_pstm_enter_verification_state
  lib-exported libmetalink.so metalink_pstm_enter_version_state
  lib-exported libmetalink.so metalink_pstm_exit_skip_state
  lib-exported libmetalink.so metalink_pstm_set_fun
  lib-exported libmetalink.so metalink_resource_delete
  lib-exported libmetalink.so metalink_resource_new
  lib-exported libmetalink.so metalink_resource_set_location
  lib-exported libmetalink.so metalink_resource_set_maxconnections
  lib-exported libmetalink.so metalink_resource_set_preference
  lib-exported libmetalink.so metalink_resource_set_priority
  lib-exported libmetalink.so metalink_resource_set_type
  lib-exported libmetalink.so metalink_resource_set_url
  lib-exported libmetalink.so metalink_session_data_delete
  lib-exported libmetalink.so metalink_session_data_new
  lib-exported libmetalink.so metalink_set_generator
  lib-exported libmetalink.so metalink_set_identity
  lib-exported libmetalink.so metalink_set_origin
  lib-exported libmetalink.so metalink_set_origin_dynamic
  lib-exported libmetalink.so metalink_set_published
  lib-exported libmetalink.so metalink_set_tags
  lib-exported libmetalink.so metalink_set_updated
  lib-exported libmetalink.so metalink_set_version
  lib-exported libmetalink.so metalink_signature_delete
  lib-exported libmetalink.so metalink_signature_new
  lib-exported libmetalink.so metalink_signature_set_mediatype
  lib-exported libmetalink.so metalink_signature_set_signature
  lib-exported libmetalink.so metalink_stack_delete
  lib-exported libmetalink.so metalink_stack_empty
  lib-exported libmetalink.so metalink_stack_new
  lib-exported libmetalink.so metalink_stack_pop
  lib-exported libmetalink.so metalink_stack_push
  lib-exported libmetalink.so metalink_stack_top
  lib-exported libmetalink.so metalink_state_end_fun_v3
  lib-exported libmetalink.so metalink_state_end_fun_v4
  lib-exported libmetalink.so metalink_state_start_fun_v3
  lib-exported libmetalink.so metalink_state_start_fun_v4
  lib-exported libmetalink.so metalink_strerror
  lib-exported libmetalink.so metalink_string_buffer_append
  lib-exported libmetalink.so metalink_string_buffer_capacity
  lib-exported libmetalink.so metalink_string_buffer_delete
  lib-exported libmetalink.so metalink_string_buffer_new
  lib-exported libmetalink.so metalink_string_buffer_str
  lib-exported libmetalink.so metalink_string_buffer_strlen
  lib-exported libmetalink.so metaurl_state_end_fun_v4
  lib-exported libmetalink.so metaurl_state_start_fun_v4
  lib-exported libmetalink.so new_metalink_pctrl
  lib-exported libmetalink.so new_metalink_pstate
  lib-exported libmetalink.so new_metalink_pstm
  lib-exported libmetalink.so null_state_end_fun
  lib-exported libmetalink.so null_state_start_fun
  lib-exported libmetalink.so origin_state_end_fun_v4
  lib-exported libmetalink.so origin_state_start_fun_v4
  lib-exported libmetalink.so os_state_end_fun
  lib-exported libmetalink.so os_state_start_fun
  lib-exported libmetalink.so piece_hash_state_end_fun
  lib-exported libmetalink.so piece_hash_state_start_fun
  lib-exported libmetalink.so pieces_state_end_fun_v3
  lib-exported libmetalink.so pieces_state_end_fun_v4
  lib-exported libmetalink.so pieces_state_start_fun_v3
  lib-exported libmetalink.so pieces_state_start_fun_v4
  lib-exported libmetalink.so published_state_end_fun_v4
  lib-exported libmetalink.so published_state_start_fun_v4
  lib-exported libmetalink.so resources_state_end_fun_v3
  lib-exported libmetalink.so resources_state_start_fun_v3
  lib-exported libmetalink.so signature_state_end_fun_v4
  lib-exported libmetalink.so signature_state_start_fun_v4
  lib-exported libmetalink.so size_state_end_fun
  lib-exported libmetalink.so size_state_start_fun
  lib-exported libmetalink.so skip_state_end_fun
  lib-exported libmetalink.so skip_state_start_fun
  lib-exported libmetalink.so tags_state_end_fun_v3
  lib-exported libmetalink.so tags_state_start_fun_v3
  lib-exported libmetalink.so updated_state_end_fun_v4
  lib-exported libmetalink.so updated_state_start_fun_v4
  lib-exported libmetalink.so url_state_end_fun
  lib-exported libmetalink.so url_state_start_fun
  lib-exported libmetalink.so verification_state_end_fun_v3
  lib-exported libmetalink.so verification_state_start_fun_v3
  lib-exported libmetalink.so version_state_end_fun
  lib-exported libmetalink.so version_state_start_fun

command "gcc -o test_bin {lib_linking_flags} test.c" "Compile binary"
  exit 0
  exist test_bin

+command "./test_bin" "Execute built binary"
  exit 0
