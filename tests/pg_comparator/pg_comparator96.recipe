# Bibop recipe for pg_comparator for PostgreSQL 9.6
# See more: https://kaos.sh/bibop

pkg pg_comparator96

fast-finish yes

var postgres_version 9.6
var pgcmp_version    3.1

var data_dir /usr/pgsql-{postgres_version}/share
var lib_dir  /usr/pgsql-{postgres_version}/lib
var bin_dir  /usr/pgsql-{postgres_version}/bin

var extension_dir {data_dir}/extension

command "-" "Check library"
  exist {lib_dir}/pgcmp.so
  mode {lib_dir}/pgcmp.so 755

command "-" "Check binary"
  app pg_comparator
  link /usr/bin/pg_comparator {bin_dir}/pg_comparator

command "-" "Check SQL files"
  exist {extension_dir}/pgcmp--{pgcmp_version}.sql
  exist {extension_dir}/pgcmp.control
