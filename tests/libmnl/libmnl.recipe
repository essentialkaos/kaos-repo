# Bibop recipe for libmnl
# See more: https://kaos.sh/bibop

pkg libmnl libmnl-devel

fast-finish yes

var lib_linking_flags "-lmnl"

command "-" "Check shared libs"
  lib-loaded libmnl.so.*

command "-" "Check headers"
  lib-header libmnl

command "-" "Check pkg-config"
  lib-config libmnl

command "-" "Check symbols exported by libmnl.so"
  lib-exported libmnl.so mnl_attr_get_len
  lib-exported libmnl.so mnl_attr_get_payload
  lib-exported libmnl.so mnl_attr_get_payload_len
  lib-exported libmnl.so mnl_attr_get_str
  lib-exported libmnl.so mnl_attr_get_type
  lib-exported libmnl.so mnl_attr_get_u16
  lib-exported libmnl.so mnl_attr_get_u32
  lib-exported libmnl.so mnl_attr_get_u64
  lib-exported libmnl.so mnl_attr_get_u8
  lib-exported libmnl.so mnl_attr_nest_cancel
  lib-exported libmnl.so mnl_attr_nest_end
  lib-exported libmnl.so mnl_attr_nest_start
  lib-exported libmnl.so mnl_attr_nest_start_check
  lib-exported libmnl.so mnl_attr_next
  lib-exported libmnl.so mnl_attr_ok
  lib-exported libmnl.so mnl_attr_parse
  lib-exported libmnl.so mnl_attr_parse_nested
  lib-exported libmnl.so mnl_attr_parse_payload
  lib-exported libmnl.so mnl_attr_put
  lib-exported libmnl.so mnl_attr_put_check
  lib-exported libmnl.so mnl_attr_put_str
  lib-exported libmnl.so mnl_attr_put_str_check
  lib-exported libmnl.so mnl_attr_put_strz
  lib-exported libmnl.so mnl_attr_put_strz_check
  lib-exported libmnl.so mnl_attr_put_u16
  lib-exported libmnl.so mnl_attr_put_u16_check
  lib-exported libmnl.so mnl_attr_put_u32
  lib-exported libmnl.so mnl_attr_put_u32_check
  lib-exported libmnl.so mnl_attr_put_u64
  lib-exported libmnl.so mnl_attr_put_u64_check
  lib-exported libmnl.so mnl_attr_put_u8
  lib-exported libmnl.so mnl_attr_put_u8_check
  lib-exported libmnl.so mnl_attr_type_valid
  lib-exported libmnl.so mnl_attr_validate
  lib-exported libmnl.so mnl_attr_validate2
  lib-exported libmnl.so mnl_cb_run
  lib-exported libmnl.so mnl_cb_run2
  lib-exported libmnl.so mnl_nlmsg_batch_current
  lib-exported libmnl.so mnl_nlmsg_batch_head
  lib-exported libmnl.so mnl_nlmsg_batch_is_empty
  lib-exported libmnl.so mnl_nlmsg_batch_next
  lib-exported libmnl.so mnl_nlmsg_batch_reset
  lib-exported libmnl.so mnl_nlmsg_batch_size
  lib-exported libmnl.so mnl_nlmsg_batch_start
  lib-exported libmnl.so mnl_nlmsg_batch_stop
  lib-exported libmnl.so mnl_nlmsg_fprintf
  lib-exported libmnl.so mnl_nlmsg_get_payload
  lib-exported libmnl.so mnl_nlmsg_get_payload_len
  lib-exported libmnl.so mnl_nlmsg_get_payload_offset
  lib-exported libmnl.so mnl_nlmsg_get_payload_tail
  lib-exported libmnl.so mnl_nlmsg_next
  lib-exported libmnl.so mnl_nlmsg_ok
  lib-exported libmnl.so mnl_nlmsg_portid_ok
  lib-exported libmnl.so mnl_nlmsg_put_extra_header
  lib-exported libmnl.so mnl_nlmsg_put_header
  lib-exported libmnl.so mnl_nlmsg_seq_ok
  lib-exported libmnl.so mnl_nlmsg_size
  lib-exported libmnl.so mnl_socket_bind
  lib-exported libmnl.so mnl_socket_close
  lib-exported libmnl.so mnl_socket_fdopen
  lib-exported libmnl.so mnl_socket_get_fd
  lib-exported libmnl.so mnl_socket_get_portid
  lib-exported libmnl.so mnl_socket_getsockopt
  lib-exported libmnl.so mnl_socket_open
  lib-exported libmnl.so mnl_socket_open2
  lib-exported libmnl.so mnl_socket_recvfrom
  lib-exported libmnl.so mnl_socket_sendto
  lib-exported libmnl.so mnl_socket_setsockopt

command "gcc -o test_bin {lib_linking_flags} test.c" "Compile binary"
  exit 0
  exist test_bin

+command "./test_bin" "Execute built binary"
  exit 0
