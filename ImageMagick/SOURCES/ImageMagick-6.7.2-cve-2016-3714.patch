From a347456a1ef3b900c20402f9866992a17eb5d181 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Mon, 2 May 2016 10:22:56 -0400
Subject: [PATCH] Second effort to sanitize input string

---
 MagickCore/property.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/magick/property.c b/magick/property.c
index cddd2dc..57caee4 100644
--- a/magick/property.c
+++ b/magick/property.c
@@ -2540,8 +2540,8 @@ static const char *GetMagickPropertyLetter(ImageInfo *image_info,
 
       static char
         whitelist[] =
-          "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_- "
-          ".@&;<>()/\\\'\":%=~`";
+          "^-ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"
+          "+&@#/%?=~_|!:,.;()";
 
       WarnNoImageReturn("\"%%%c\"",letter);
       (void) CopyMagickString(value,image->magick_filename,MagickPathExtent);